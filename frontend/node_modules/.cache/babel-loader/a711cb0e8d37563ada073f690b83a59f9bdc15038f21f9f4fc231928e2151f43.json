{"ast":null,"code":"import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faCircleXmark}from\"@fortawesome/free-solid-svg-icons\";import\"./reserve.css\";import useFetch from\"../../hooks/useFetch\";import{useContext,useState}from\"react\";import{SearchContext}from\"../../context/SearchContext\";import axios from\"axios\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Reserve=_ref=>{let{setOpen,hotelId}=_ref;const[selectedRooms,setSelectedRooms]=useState([]);const{data,loading,error}=useFetch(\"/hotels/room/\".concat(hotelId));const{dates}=useContext(SearchContext);const getDatesInRange=(startDate,endDate)=>{const start=new Date(startDate);const end=new Date(endDate);const date=new Date(start.getTime());const dates=[];while(date<=end){dates.push(new Date(date).getTime());date.setDate(date.getDate()+1);}return dates;};const alldates=getDatesInRange(dates[0].startDate,dates[0].endDate);const isAvailable=roomNumber=>{const isFound=roomNumber.unavailableDates.some(date=>alldates.includes(new Date(date).getTime()));return!isFound;};const handleSelect=e=>{const checked=e.target.checked;const value=e.target.value;setSelectedRooms(checked?[...selectedRooms,value]:selectedRooms.filter(item=>item!==value));};const navigate=useNavigate();const handleClick=async()=>{try{await Promise.all(selectedRooms.map(roomId=>{const res=axios.put(\"/rooms/availability/\".concat(roomId),{dates:alldates});// console.log(res.data);\nreturn res.data;}));setOpen(false);navigate(\"/\");}catch(err){}};return/*#__PURE__*/_jsx(\"div\",{className:\"reserve\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"rContainer\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCircleXmark,className:\"rClose\",onClick:()=>setOpen(false)}),/*#__PURE__*/_jsx(\"span\",{children:\"Select your rooms:\"}),data.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"rItem\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"rItemInfo\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rTitle\",children:item.title}),/*#__PURE__*/_jsx(\"div\",{className:\"rDesc\",children:item.desc}),/*#__PURE__*/_jsxs(\"div\",{className:\"rMax\",children:[\"Max people: \",/*#__PURE__*/_jsx(\"b\",{children:item.maxPeople})]}),/*#__PURE__*/_jsx(\"div\",{className:\"rPrice\",children:item.price})]}),/*#__PURE__*/_jsx(\"div\",{className:\"rSelectRooms\",children:item.roomNumbers.map(roomNumber=>/*#__PURE__*/_jsxs(\"div\",{className:\"room\",children:[/*#__PURE__*/_jsx(\"label\",{children:roomNumber.number}),/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",value:roomNumber._id,onChange:handleSelect,disabled:!isAvailable(roomNumber)})]}))})]},item._id)),/*#__PURE__*/_jsx(\"button\",{onClick:handleClick,className:\"rButton\",children:\"Reserve Now!\"})]})});};export default Reserve;","map":{"version":3,"names":["FontAwesomeIcon","faCircleXmark","useFetch","useContext","useState","SearchContext","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","Reserve","_ref","setOpen","hotelId","selectedRooms","setSelectedRooms","data","loading","error","concat","dates","getDatesInRange","startDate","endDate","start","Date","end","date","getTime","push","setDate","getDate","alldates","isAvailable","roomNumber","isFound","unavailableDates","some","includes","handleSelect","e","checked","target","value","filter","item","navigate","handleClick","Promise","all","map","roomId","res","put","err","className","children","icon","onClick","title","desc","maxPeople","price","roomNumbers","number","type","_id","onChange","disabled"],"sources":["C:/Users/NIDHI/Desktop/WebSite Booking/frontend/src/components/reserve/Reserve.jsx"],"sourcesContent":["import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faCircleXmark } from \"@fortawesome/free-solid-svg-icons\";\nimport \"./reserve.css\";\nimport useFetch from \"../../hooks/useFetch\";\nimport { useContext, useState } from \"react\";\nimport { SearchContext } from \"../../context/SearchContext\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst Reserve = ({ setOpen, hotelId }) => {\n  const [selectedRooms, setSelectedRooms] = useState([]);\n  const { data, loading, error } = useFetch(`/hotels/room/${hotelId}`);\n  const { dates } = useContext(SearchContext);\n\n  const getDatesInRange = (startDate, endDate) => {\n    const start = new Date(startDate);\n    const end = new Date(endDate);\n\n    const date = new Date(start.getTime());\n\n    const dates = [];\n\n    while (date <= end) {\n      dates.push(new Date(date).getTime());\n      date.setDate(date.getDate() + 1);\n    }\n\n    return dates;\n  };\n\n  const alldates = getDatesInRange(dates[0].startDate, dates[0].endDate);\n\n  const isAvailable = (roomNumber) => {\n    const isFound = roomNumber.unavailableDates.some((date) =>\n      alldates.includes(new Date(date).getTime())\n    );\n\n    return !isFound;\n  };\n\n  const handleSelect = (e) => {\n    const checked = e.target.checked;\n    const value = e.target.value;\n    setSelectedRooms(\n      checked\n        ? [...selectedRooms, value]\n        : selectedRooms.filter((item) => item !== value)\n    );\n  };\n\n  const navigate = useNavigate();\n\n  const handleClick = async () => {\n    try {\n      await Promise.all(\n        selectedRooms.map((roomId) => {\n          const res = axios.put(`/rooms/availability/${roomId}`, {\n            dates: alldates,\n          });\n         // console.log(res.data);\n          return res.data;\n\n        })\n      );\n      setOpen(false);\n      navigate(\"/\");\n    } catch (err) {}\n  };\n  return (\n    <div className=\"reserve\">\n      <div className=\"rContainer\">\n        <FontAwesomeIcon\n          icon={faCircleXmark}\n          className=\"rClose\"\n          onClick={() => setOpen(false)}\n        />\n        <span>Select your rooms:</span>\n        {data.map((item) => (\n          <div className=\"rItem\" key={item._id}>\n            <div className=\"rItemInfo\">\n              <div className=\"rTitle\">{item.title}</div>\n              <div className=\"rDesc\">{item.desc}</div>\n              <div className=\"rMax\">\n                Max people: <b>{item.maxPeople}</b>\n              </div>\n              <div className=\"rPrice\">{item.price}</div>\n            </div>\n            <div className=\"rSelectRooms\">\n              {item.roomNumbers.map((roomNumber) => (\n                <div className=\"room\">\n                  <label>{roomNumber.number}</label>\n                  <input\n                    type=\"checkbox\"\n                    value={roomNumber._id}\n                    onChange={handleSelect}\n                    disabled={!isAvailable(roomNumber)}\n                  />\n                </div>\n              ))}\n            </div>\n          </div>\n        ))}\n        <button onClick={handleClick} className=\"rButton\">\n          Reserve Now!\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default Reserve;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}